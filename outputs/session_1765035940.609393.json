{
  "filename": "heartbleed.c",
  "c_code": "struct {\n    HeartbeatMessageType type;  // 1 byte: request or the response\n    uint16 payload_length;      // 2 byte: the length of the payload\n    opaque payload[HeartbeatMessage.payload_length];\n    opaque padding[padding_length];\n} HeartbeatMessage;\n/* Allocate memory for the response, size is 1 byte\n * message type, plus 2 bytes payload length, plus\n * payload, plus padding\n*/\n\nunsigned int payload;\nunsigned int padding = 16; /* Use minimum padding */\n\n// Read from type field first\nhbtype = *p++; /* After this instruction, the pointer\n                * p will point to the payload_length field */\n\n// Read from the payload_length field from the request packet\nn2s(p, payload); /* Function n2s(p, payload) reads 16 bits\n                  * from pointer p and store the value\n                  * in the INT variable \"payload\". */\n\npl = p; // pl points to the beginning of the payload content\n\nif (hbtype == TLS1_HB_REQUEST)\n{\n    unsigned char *buffer, *bp;\n    int r;\n\n    /* Allocate memory for the response, size is 1 byte\n     * message type, plus 2 bytes payload length, plus\n     * payload, plus padding\n     */\n\n    buffer = OPENSSL_malloc(1 + 2 + payload + padding);\n    bp = buffer;\n\n    // Enter response type, length and copy payload *bp++ = TLS1_HB_RESPONSE;\n    s2n(payload, bp);\n\n    // copy payload\n    memcpy(bp, pl, payload);   /* pl is the pointer which\n                                * points to the beginning\n                                * of the payload content */\n    bp += payload;\n\n    // Random padding\n    RAND_pseudo_bytes(bp, padding);\n\n    // this function will copy the 3+payload+padding bytes\n    // from the buffer and put them into the heartbeat response\n    // packet to send back to the request client side.\n    OPENSSL_free(buffer);\n    r = ssl3_write_bytes(s, TLS1_RT_HEARTBEAT, buffer, 3 + payload + padding);\n}",
  "test_cases": [],
  "theory": "",
  "proof_success": false,
  "proof_messages": [],
  "timestamp": 1765035940.609393
}